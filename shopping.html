<!DOCTYPE html>
<html lang="en">
<head>
  <title>WinGo Mall</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body {margin:0;background:#f6f7fb;font-family:'Inter',sans-serif;}
    header {background:#232f3e;color:#ffdd00;padding:18px 18px 10px 18px;box-shadow:0 2px 8px #0002;}
    .brand {font-size:2em;font-weight:800;letter-spacing:.5px;}
    nav {margin-top:9px;}
    nav button {background:transparent;border:none;color:#ffe27d;font-weight:600;font-size:1.07em;padding:7px 20px 7px 0;cursor:pointer;}
    nav button.active {color:#232f3e;background:#ffec90;border-radius:0 9px 9px 0;font-weight:800;}
    .main {padding:27px 0 0 0;}
    .product-cat {margin:0 auto 18px auto;max-width:1050px;}
    h2 {font-size:1.38em;color:#222d3e; margin-left:16px; margin-bottom:17px;}
    .grid {display:flex;flex-wrap:wrap;gap:18px;justify-content:flex-start;}
    .p-card {
      background:#fff;
      border-radius:13px;
      min-width:200px;max-width:210px;
      box-shadow:0 2px 18px #0001, 0 1.5px 8px #fff2;
      padding:15px 14px;
      display:flex;flex-direction:column;align-items:center;
      position:relative;transition:box-shadow .22s;
    }
    .p-card:hover {box-shadow:0 5px 32px #ffefac55;}
    .p-card img {width:125px;height:105px;object-fit:contain;}
    .p-title {font-weight:600;margin-top:9px;font-size:1.08em;}
    .p-price { color:#ffa600; font-weight:700; margin:12px 0 6px 0;}
    .p-desc {font-size:.95em;color:#777;height:22px;overflow:hidden;}
    .p-card input[type=number]{margin-top:7px;border:1px solid #eee;border-radius:5px;padding:6px 10px;width:66px;}
    .p-card button {background:#ffd900;color:#232f3e;border:none;border-radius:6px;padding:7px 14px;font-weight:800;font-size:1em;cursor:pointer;margin-top:11px;}
    .cart-fab {
      position:fixed;bottom:26px;right:28px;background:#ffd900;
      color:#232f3e;border:none;width:54px;height:54px;border-radius:50%;font-size:2em;
      box-shadow:0 7px 32px #0003;z-index:999;cursor:pointer;display:flex;align-items:center;justify-content:center;
    }
    .cart-pop {position:fixed;right:22px;bottom:90px;background:#fff;color:#222;box-shadow:0 5px 40px #0003;padding:21px 20px 17px 20px;border-radius:14px;min-width:270px;max-width:95vw;z-index:999;}
    .cart-pop h3 {margin:0 0 8px 0;}
    .cart-it {margin-bottom:7px;}
    .cart-it span {font-weight:700;}
    .checkout-btn {width:100%;background:#ffd900;color:#1b2435;font-weight:800;padding:10px 0;border:none;border-radius:6px;font-size:1.08em;margin:11px 0 6px 0;}
    .empty-cart {color:#aaa;margin:14px 0;}
    .close-cart {position:absolute;right:11px;top:10px;font-size:1.4em;cursor:pointer;color:#aaa;}
    @media(max-width:700px){.grid{justify-content:center;}.main{padding-top:18px;}}
    @media(max-width:540px){
      .p-card{max-width:97vw;}
      .brand{font-size:1.36em;}
      nav{font-size:1em;}
      .main{padding-top:7px;}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">WinGo Mall</div>
    <nav id="cat-nav"></nav>
  </header>
  <div class="main" id="main"></div>
  <button class="cart-fab" onclick="showCart()">
    ðŸ›’
    <span id="cart-badge" style="position:absolute;bottom:8px;right:12px;min-width:21px;background:#ffb900;color:#232f3e;font-weight:900;font-size:.93em;border-radius:10px;padding:0 6px;">0</span>
  </button>
  <div id="cart-popover" style="display:none;"></div>
<script>
// Demo data, add as many images/products/categories as you like!
const PRODUCTS = {
  "Electronics":[
    {id:"e1",title:"Wireless Earbuds", img:"https://m.media-amazon.com/images/I/51dJQia4bBL._SL1500_.jpg", price:1099, desc:"Deep bass, 20hr backup"},
    {id:"e2",title:"Bluetooth Speaker", img:"https://m.media-amazon.com/images/I/81aBldkrtKL._SL1500_.jpg", price:899, desc:"Portable 10W, USB/AUX"},
    {id:"e3",title:"Powerbank 10000mAh", img:"https://m.media-amazon.com/images/I/61kWB+uzR2L._SL1500_.jpg", price:1299, desc:"2 output, fast charge"},
    {id:"e4",title:"LED Ring Light", img:"https://m.media-amazon.com/images/I/51Y23Lh6FrL._SL1200_.jpg", price:599, desc:"Remote selfie ring"},
  ],
  "Fashion":[
    {id:"f1",title:"Cotton T-shirt", img:"https://m.media-amazon.com/images/I/61cU5ZC0L4L._SL1500_.jpg", price:349, desc:"Available: M,L,XL"},
    {id:"f2",title:"Analog Watch", img:"https://m.media-amazon.com/images/I/71dwTw1vDSL._UL1500_.jpg", price:499, desc:"Trendy, Unisex"},
    {id:"f3",title:"Sneakers", img:"https://m.media-amazon.com/images/I/61vU1i2tCrL._SL1500_.jpg", price:899, desc:"Sizes: 7-11"},
    {id:"f4",title:"Sunglasses", img:"https://m.media-amazon.com/images/I/71TKZv9A9zL._UL1500_.jpg", price:349, desc:"UV400, stylish"},
  ],
  "Toys":[
    {id:"t1",title:"Toy Car", img:"https://m.media-amazon.com/images/I/61eMy9quZtL._SL1200_.jpg", price:129, desc:"Friction, 1:36 scale"},
    {id:"t2",title:"Blocks Set", img:"https://m.media-amazon.com/images/I/91-lb7-v18L._SL1500_.jpg", price:220, desc:"110 pieces, DIY"},
    {id:"t3",title:"Dancing Robot", img:"https://m.media-amazon.com/images/I/61guTTHA5CL._SL1361_.jpg", price:339, desc:"Sound, light"},
    {id:"t4",title:"Teddy Bear", img:"https://m.media-amazon.com/images/I/71XnG2zpSJL._SL1500_.jpg", price:390, desc:"Soft, 40cm"}
  ],
  "Home":[
    {id:"h1",title:"Steel Flask", img:"https://m.media-amazon.com/images/I/61OZQ4I9vHL._SL1500_.jpg", price:319, desc:"750ml, leak proof"},
    {id:"h2",title:"Table Lamp", img:"https://m.media-amazon.com/images/I/616K219GrhL._SL1500_.jpg", price:379, desc:"LED, touch style"},
    {id:"h3",title:"Cushion Cover", img:"https://m.media-amazon.com/images/I/71ktYa6mODL._SL1500_.jpg", price:170, desc:"Set of 2, size: 16x16"},
    {id:"h4",title:"Wall Clock", img:"https://m.media-amazon.com/images/I/81efyG7t5hL._SL1500_.jpg", price:249, desc:"Silent sweep, 12in"}
  ],
  "WinGo Points":[
    {id:"wp1", title:"WinGo Points", img:"https://cdn.pixabay.com/photo/2017/06/02/16/24/coins-2365680_1280.png", price:1, desc:"Custom quantity, instantly updates game!"}
  ]
};
const CATEGORIES = Object.keys(PRODUCTS);

let currentCat = CATEGORIES[0];
let cart = [];

function renderCategories(){
  const nav = document.getElementById('cat-nav');
  nav.innerHTML = "";
  CATEGORIES.forEach(cat=>{
    const btn = document.createElement('button');
    btn.textContent = cat;
    btn.className = (cat === currentCat) ? "active" : "";
    btn.onclick = () => {currentCat=cat;renderProducts();}
    nav.appendChild(btn);
  });
}
function renderProducts(){
  const main = document.getElementById('main');
  main.innerHTML = `<div class="product-cat"><h2>${currentCat}</h2><div class="grid" id="grid"></div></div>`;
  const grid = document.getElementById('grid');
  PRODUCTS[currentCat].forEach(p=>{
    const d = document.createElement('div');
    d.className = "p-card";
    d.innerHTML = `<img src="${p.img}" alt="">
      <div class="p-title">${p.title}</div>
      <div class="p-price">${currentCat==="WinGo Points"?"â‚¹1/pt":"â‚¹"+p.price}</div>
      <div class="p-desc">${p.desc||""}</div>
      ${currentCat==="WinGo Points"
        ?'<input type="number" id="qtyIn" min="1" value="100" style="margin-bottom:6px;"><button onclick="addPointsToCart()">Add to Cart</button>'
        :'<button onclick="addToCart(\''+p.id+'\')">Add to Cart</button>'
      }
    `;
    grid.appendChild(d);
  });
}

function addToCart(id){
  // normal product
  let p = PRODUCTS[currentCat].find(prod=>prod.id===id);
  if(!p) return;
  let idx = cart.findIndex(i=>i.id===id);
  if(idx>-1) cart[idx].qty += 1;
  else cart.push({...p, qty:1});
  updateCartBadge();
}
function addPointsToCart(){
  const qty = parseInt(document.getElementById('qtyIn').value,10)||0;
  if(qty<1){ alert("Enter points."); return;}
  let item = cart.find(i=>i.id==='wp1');
  if(item) item.qty+=qty;
  else cart.push({...PRODUCTS["WinGo Points"][0], qty});
  updateCartBadge();
}

function updateCartBadge(){
  const sum = cart.reduce((a,b)=>a+b.qty,0);
  document.getElementById('cart-badge').textContent = sum;
}
function showCart(){
  const pop = document.getElementById('cart-popover');
  pop.style.display="block";
  let total = 0;
  pop.innerHTML = `<span class="close-cart" onclick="hideCart()">Ã—</span><h3>Your Cart</h3>`;
  cart.forEach(item=>{
    const line = item.id==="wp1"
      ? `<div class="cart-it"><span>Points:</span> ${item.qty} x â‚¹1 = â‚¹${item.qty}</div>`
      : `<div class="cart-it"><span>${item.title}:</span> x${item.qty} = â‚¹${item.price*item.qty}</div>`;
    pop.innerHTML += line;
    total += (item.price*item.qty);
  });
  if(!cart.length) pop.innerHTML += `<div class="empty-cart">Cart is empty.</div>`;
  pop.innerHTML += `<div><b>Total: â‚¹${total}</b></div><button class="checkout-btn" onclick="checkout()">Checkout</button>`;
}
function hideCart(){ document.getElementById('cart-popover').style.display="none"; }
function checkout(){
  const pop = document.getElementById('cart-popover');
  if(cart.length==0){ pop.innerHTML = '<div class="empty-cart">Nothing to checkout!</div>'; return;}
  // Demo: instantly "order success" all physical, call API for WinGo points
  const userToken = localStorage.getItem('token');
  if(cart.find(i=>i.id==="wp1") && !userToken){
    pop.innerHTML += `<div style="color:#e24f4f;margin-top:14px;">Login required to add points!</div>`;
    return;
  }
  if(cart.find(i=>i.id==="wp1")){
    const points = cart.find(i=>i.id==="wp1").qty;
    fetch("https://wingo-backend-nqk5.onrender.com/api/users/wallet/recharge",{
      method:"POST",
      headers:{"Authorization":"Bearer "+userToken,"Content-Type":"application/json"},
      body:JSON.stringify({amount:points})
    }).then(r=>r.json()).then(data=>{
      if(!data.message) pop.innerHTML += `<div style="color:#19ae5f;margin-top:10px;">+${points} points instantly added!</div>`;
      else pop.innerHTML += `<div style="color:#e24f4f;margin-top:10px;">${data.message}</div>`;
      cart = cart.filter(i=>i.id!=="wp1"); updateCartBadge();
    });
  }
  pop.innerHTML += '<div style="color:#19ae5f;margin-top:12px;">Order for physical products simulated (delivery soon)!</div>';
  cart=cart.filter(i=>i.id==="wp1"); updateCartBadge();
}
renderCategories(); renderProducts();
updateCartBadge();
</script>
</body>
</html>
